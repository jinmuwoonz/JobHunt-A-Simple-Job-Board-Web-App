{% extends 'base.html' %}

{% block title %}Job Details{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm border-0">
    <div class="card-body">
      <h3 class="card-title text-center mb-4">{{ job.title }}</h3>

      <div class="mb-3">
        <strong>Description:</strong>
        <p class="text-muted">{{ job.description }}</p>
      </div>

      <div class="mb-3">
        <strong>Requirements:</strong>
        <p class="text-muted">{{ job.requirements }}</p>
      </div>

      <div class="mb-3">
        <strong>Location:</strong>
        <span class="badge badge-secondary text-dark">{{ job.location }}</span>
      </div>

      <div class="mb-3">
        <strong>Salary:</strong>
        <span class="badge badge-light text-dark">
          â‚±{{ '{:,g}'.format(job.salary_min) }} - {{ '{:,g}'.format(job.salary_max) }}
        </span>
      </div>

      <div class="mb-3">
        <strong>Date Posted:</strong>
        <span class="badge badge-light text-dark">{{ job.date_posted.date() }}</span>
      </div>

      {% if job.date_updated is not none %}
        <div class="mb-3">
          <strong>Date Updated:</strong>
          <span class="badge badge-light text-dark">{{ job.date_updated.date() }}</span>
        </div>
      {% endif %}

    {% if current_user.is_authenticated %}
      {% if current_user.user_type == 'applicant' %}
        {% if isApplied == False %}
          <a href="{{ url_for('jobs_bp.job_apply', job_id=job.id) }}" class="btn btn-sm btn-outline-primary">Apply</a>
        {% else %}
          <span class="badge bg-success">Already Applied</span>
        {% endif %}
      {% endif %}

      {% if current_user.user_type == 'employer' %}
        {% if current_user.user_id == job.employer_id %}
          <form method="post" action="{{ url_for('jobs_bp.job_delete', job_id=job.id) }}" onsubmit="return confirm('Are you sure you want to delete this job?');">
            <a href="{{ url_for('jobs_bp.job_edit', job_id=job.id) }}" class="btn btn-sm btn-outline-warning">Edit</a>
            <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
          </form>
        {% else %}
          <span class="badge bg-info">You can't apply here</span>
        {% endif %}
      {% endif %}

      {% else %}
        <a href="{{ url_for('auth_bp.login') }}" class="btn btn-sm btn-outline-primary">Apply</a>
    {% endif %}
    </div>
  </div>
</div>
{% endblock %}
